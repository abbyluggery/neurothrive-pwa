<!--
  SECRET UNLOCK TEMPLATE

  This file contains the Settings tab with hidden SafeHaven deep link unlock.

  INTEGRATION INSTRUCTIONS:
  1. Add Settings tab to navigation (see SECTION 1 below)
  2. Add Settings tab content (see SECTION 2 below)
  3. Add JavaScript for secret unlock (see SECTION 3 below)
  4. Add Settings to bottom navigation (see SECTION 4 below)
-->

<!-- ============================================ -->
<!-- SECTION 1: Add to Navigation Tabs (line ~750) -->
<!-- ============================================ -->
<!-- Find this in index.html around line 750:
    <nav class="nav-tabs">
        <div class="nav-tabs-inner">
            <button class="nav-tab active" data-tab="dashboard">Dashboard</button>
            <button class="nav-tab" data-tab="journal">Journal</button>
            <button class="nav-tab" data-tab="routine">Routine</button>
            <button class="nav-tab" data-tab="therapy">Therapy</button>
            <button class="nav-tab" data-tab="jobsearch">Job Search</button>
            <!-- ADD THIS LINE: -->
            <button class="nav-tab" data-tab="settings">Settings</button>
        </div>
    </nav>
-->

<!-- ============================================ -->
<!-- SECTION 2: Add Settings Tab Content (after jobsearch tab, around line 1200) -->
<!-- ============================================ -->

        <!-- Settings Tab (with SECRET UNLOCK) -->
        <div id="settings" class="tab-content">
            <div class="card">
                <h2 class="card-title">
                    <span>‚öôÔ∏è</span>
                    Settings
                </h2>

                <!-- Data Sync Section -->
                <div style="margin: 1.5rem 0;">
                    <h3 style="font-size: 1.1rem; margin-bottom: 0.5rem; font-weight: 600;">Data Sync</h3>
                    <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 1rem;">
                        Connect to Salesforce to sync your wellness data across devices
                    </p>
                    <button class="button-primary" onclick="window.syncManager && syncManager.syncAll ? syncManager.syncAll() : alert('Sync manager initializing...')" style="width: 100%;">
                        üîÑ Sync Now
                    </button>
                </div>

                <hr style="margin: 1.5rem 0; border: none; border-top: 1px solid #e0e0e0;">

                <!-- Offline Mode -->
                <div style="margin: 1.5rem 0;">
                    <h3 style="font-size: 1.1rem; margin-bottom: 0.5rem; font-weight: 600;">Offline Mode</h3>
                    <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 1rem;">
                        All features work offline. Data automatically syncs when you're connected.
                    </p>
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: not-allowed;">
                        <input type="checkbox" checked disabled style="width: 20px; height: 20px;">
                        <span>Offline support enabled</span>
                    </label>
                </div>

                <hr style="margin: 1.5rem 0; border: none; border-top: 1px solid #e0e0e0;">

                <!-- App Version (SECRET UNLOCK TRIGGER) -->
                <div style="margin: 1.5rem 0; cursor: pointer; user-select: none; padding: 0.5rem; border-radius: 4px; transition: background 0.1s;"
                     id="versionSection"
                     onclick="handleVersionTap()">
                    <h3 style="font-size: 1.1rem; margin-bottom: 0.5rem; font-weight: 600;">App Information</h3>
                    <p style="color: var(--text-secondary); font-size: 0.9rem; margin: 0;">
                        Version: <span id="appVersion">1.2.3</span>
                    </p>
                    <p style="color: var(--text-secondary); font-size: 0.75rem; font-style: italic; margin-top: 0.5rem; opacity: 0.6;">
                        Tap here 7 times to unlock advanced features
                    </p>
                </div>

                <!-- Advanced Privacy Features (HIDDEN - Shows after 7 taps) -->
                <div id="advancedFeatures"
                     style="display: none; margin-top: 1.5rem; padding: 1.5rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; color: white; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                    <h3 style="font-size: 1.2rem; margin-bottom: 0.75rem; color: white; font-weight: 600;">
                        üîê Advanced Privacy Features
                    </h3>
                    <p style="font-size: 0.9rem; margin-bottom: 1.25rem; opacity: 0.95; line-height: 1.5;">
                        Access enhanced data protection and security tools designed for maximum privacy and safety.
                    </p>
                    <button class="button-primary"
                            onclick="openSafeHavenApp()"
                            style="width: 100%; background: white; color: #667eea; font-weight: bold; padding: 0.75rem; font-size: 1rem; border: none; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        üõ°Ô∏è Enable Advanced Protection
                    </button>
                </div>

                <hr style="margin: 1.5rem 0; border: none; border-top: 1px solid #e0e0e0;">

                <!-- About -->
                <div style="margin: 1.5rem 0;">
                    <h3 style="font-size: 1.1rem; margin-bottom: 0.5rem; font-weight: 600;">About NeuroThrive</h3>
                    <p style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.6;">
                        Your neurodivergent support companion, designed to help you thrive with ADHD,
                        track your wellness, and maintain healthy routines.
                    </p>
                    <p style="color: var(--text-secondary); font-size: 0.85rem; margin-top: 0.75rem;">
                        Made with üíú for the neurodivergent community
                    </p>
                </div>
            </div>
        </div>

<!-- ============================================ -->
<!-- SECTION 3: Add JavaScript (before closing </script> tag, around line 1700) -->
<!-- ============================================ -->

        // ========================================
        // SECRET UNLOCK FUNCTIONALITY
        // ========================================
        let versionTapCount = 0;
        let versionTapTimer = null;

        function handleVersionTap() {
            versionTapCount++;

            // Visual feedback
            const versionSection = document.getElementById('versionSection');
            if (versionSection) {
                versionSection.style.background = '#f0f0f0';
                setTimeout(() => {
                    versionSection.style.background = 'transparent';
                }, 100);
            }

            // Clear previous timer
            clearTimeout(versionTapTimer);

            // Check if 7 taps reached
            if (versionTapCount === 7) {
                // UNLOCK ADVANCED FEATURES
                const advancedFeatures = document.getElementById('advancedFeatures');
                if (advancedFeatures) {
                    advancedFeatures.style.display = 'block';

                    // Animate in
                    advancedFeatures.style.opacity = '0';
                    advancedFeatures.style.transform = 'translateY(-20px)';
                    setTimeout(() => {
                        advancedFeatures.style.transition = 'all 0.5s ease';
                        advancedFeatures.style.opacity = '1';
                        advancedFeatures.style.transform = 'translateY(0)';
                    }, 10);

                    // Store that advanced features were unlocked
                    localStorage.setItem('neurothrive_advanced_unlocked', 'true');

                    // Reset counter
                    versionTapCount = 0;

                    // Success feedback
                    console.log('üîì Advanced Privacy Features Unlocked');
                }
            } else {
                // Reset counter after 2 seconds if not all taps completed
                versionTapTimer = setTimeout(() => {
                    versionTapCount = 0;
                }, 2000);
            }
        }

        function openSafeHavenApp() {
            // Try to open Android app via deep link
            const deepLinkUrl = 'neurothrive://safehaven/unlock';

            console.log('üîó Attempting to open SafeHaven app via deep link...');
            window.location.href = deepLinkUrl;

            // Fallback: Offer Play Store download after 1.5 seconds
            setTimeout(() => {
                const playStoreUrl = 'https://play.google.com/store/apps/details?id=app.neurothrive.safehaven.plus';

                const downloadApp = confirm(
                    'NeuroThrive Plus app not detected.\n\n' +
                    'Would you like to download it from the Play Store?\n\n' +
                    'NeuroThrive Plus provides enhanced privacy and data protection features.'
                );

                if (downloadApp) {
                    window.open(playStoreUrl, '_blank');
                }
            }, 1500);
        }

        // Check if advanced features were previously unlocked
        window.addEventListener('load', () => {
            if (localStorage.getItem('neurothrive_advanced_unlocked') === 'true') {
                const advancedFeatures = document.getElementById('advancedFeatures');
                if (advancedFeatures) {
                    advancedFeatures.style.display = 'block';
                }
            }
        });

<!-- ============================================ -->
<!-- SECTION 4: Add to Bottom Navigation (around line 1050) -->
<!-- ============================================ -->
<!-- Find the bottom navigation and add this button:

        <button class="bottom-nav-item" onclick="switchTab('settings')">
            <span class="bottom-nav-icon">‚öôÔ∏è</span>
            <span class="bottom-nav-label">Settings</span>
        </button>
-->

<!-- ============================================ -->
<!-- INTEGRATION COMPLETE -->
<!-- ============================================ -->

<!--
TESTING THE SECRET UNLOCK:
1. Deploy PWA to GitHub Pages
2. Open PWA in browser
3. Navigate to Settings tab
4. Tap "App Information" section 7 times rapidly
5. "Advanced Privacy Features" section should appear
6. Click "Enable Advanced Protection" button
7. Verify deep link attempt (will prompt for Play Store if app not installed)

SECURITY NOTES:
- Deep link URL: neurothrive://safehaven/unlock
- No obvious DV/SafeHaven references in UI
- Unlock state persists in localStorage
- Fallback to Play Store for app download
- Works on all platforms (iOS opens App Store, Android opens Play Store)

NEXT STEPS:
After adding this to index.html:
1. Test locally with: python -m http.server 8080
2. Verify secret unlock works
3. Commit and push to GitHub
4. Enable GitHub Pages
5. Configure Android deep linking in SafeHaven-Build
-->
